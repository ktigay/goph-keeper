name: linters

on: [pull_request]

jobs:
  unittest:
    runs-on: ubuntu-latest
    steps:
       - name: Install Task
         uses: arduino/setup-task@v2
         with:
           version: 3.x
           repo-token: ${{ secrets.GITHUB_TOKEN }}

       - name: Checkout code
         uses: actions/checkout@v4
       - name: Setup Go
         uses: actions/setup-go@v5
         with:
           go-version: "^1.25"
           cache: true

       - name: Git config
         run: git config --global --add safe.directory '*'

       - name: Install golangci-lint
         run: |
           go install github.com/golangci/golangci-lint/cmd/golangci-lint@latest

       - name: Install godoclint
         run: go install github.com/godoc-lint/godoc-lint/cmd/godoclint@v0.10.1

       - name: Run vet
         run: |
           go vet ./...

       - name: Run golangci-lint
         run: |
           golangci-lint run

       - name: Run godoclint
         run: |
           godoclint -config .godoc-lint.yaml ./...
